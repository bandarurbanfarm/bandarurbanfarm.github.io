<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Bandar Urban Farm - Transformasi lahan sempit perkotaan untuk beternak dan berkebun.">
    <meta name="keywords" content="urban farming, gardening, berkebun, beternak, bertani">
    <meta name="author" content="Bandar Urban Farm">
    <meta property="og:title" content="Bandar Urban Farm - Solusi Tani Ala Kota">
    <meta property="og:description" content="Transformasi lahan sempit perkotaan untuk beternak dan berkebun.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://bandarurbanfarm.github.io/">
    <meta property="og:image" content="https://bandarurbanfarm.github.io/image/buf-logo.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Bandar Urban Farm - Solusi Tani Ala Kota">
    <meta name="twitter:description" content="Transformasi lahan sempit perkotaan untuk beternak dan berkebun.">
    <meta name="twitter:image" content="https://bandarurbanfarm.github.io/image/buf-logo.jpg">
    <title>Bandar Urban Farm - Transformasi lahan sempit perkotaan untuk beternak dan berkebun.</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-color: #22c55e;
            --secondary-color: #10b981;
            --accent-color: #f59e0b;
            --text-color: #1f2937;
            --light-text: #6b7280;
            --bg-color: #f9fafb;
            --card-bg: #ffffff;
            --border-color: #e5e7eb;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --hover-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --header-height: 80px;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        /* Header Styles */
        header {
            background-color: white;
            box-shadow: var(--shadow);
            border-bottom: 1px solid var(--border-color);
            padding: 0;
            position: sticky;
            top: 0;
            z-index: 100;
            height: var(--header-height);
        }
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 100%;
        }
        .logo {
            display: flex;
            flex-direction: column;
        }
        .logo h1 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        .logo p {
            color: var(--light-text);
            font-size: 0.8rem;
        }
        /* Mobile responsive logo */
        @media (max-width: 768px) {
            .logo h1 {
                font-size: 1.5rem;
            }
            .logo p {
                display: none;
            }
        }
        /* Navigation */
        .desktop-nav {
            display: flex;
        }
        .desktop-nav ul {
            display: flex;
            list-style: none;
            gap: 25px;
            margin-right: 20px;
        }
        .desktop-nav a {
            color: var(--text-color);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
            padding: 5px 0;
            position: relative;
        }
        .desktop-nav a:hover {
            color: var(--primary-color);
        }
        .desktop-nav a.active {
            color: var(--primary-color);
        }
        .desktop-nav a.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: var(--primary-color);
        }
        /* Search */
        .header-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .search-container {
            position: relative;
            width: 250px;
        }
        .search-input {
            width: 100%;
            padding: 10px 12px 10px 40px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
        }
        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--light-text);
        }
        .menu-toggle {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px 10px;
            display: none;
        }
        /* Mobile Navigation */
        .nav-menu {
            position: fixed;
            top: 0;
            right: -300px;
            width: 300px;
            height: 100vh;
            background-color: white;
            box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            transition: right 0.3s ease;
            z-index: 1000;
            padding: 20px;
        }
        .nav-menu.active {
            right: 0;
        }
        .nav-menu h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--light);
        }
        .nav-menu ul {
            list-style: none;
        }
        .nav-menu li {
            margin-bottom: 15px;
        }
        .nav-menu a {
            color: var(--text-color);
            text-decoration: none;
            font-size: 1.1rem;
            transition: color 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .nav-menu a:hover {
            color: var(--primary-color);
        }
        .close-menu {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
        }
        /* Hero Section */
        .hero {
            background: linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url('https://images.unsplash.com/photo-1416879595882-3373a0480b5b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1200&q=80') center/cover no-repeat;
            color: white;
            padding: 100px 0;
            text-align: center;
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
        }
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.7) 0%, rgba(16, 185, 129, 0.7) 100%);
            z-index: -1;
        }
        .hero-content {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
            animation: fadeInUp 1s ease-out;
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .hero h2 {
            font-size: 2.8rem;
            margin-bottom: 20px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
        }
        .hero p {
            font-size: 1.3rem;
            margin-bottom: 30px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        .cta-button {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(245, 158, 11, 0.3);
        }
        .cta-button:hover {
            background-color: #e69008;
            transform: translateY(-2px);
            box-shadow: 0 6px 10px rgba(245, 158, 11, 0.4);
        }
        /* Newsletter Section */
        .newsletter {
            background-color: var(--primary-color);
            color: white;
            padding: 50px 0;
            text-align: center;
        }
        .newsletter-content {
            max-width: 600px;
            margin: 0 auto;
        }
        .newsletter h2 {
            font-size: 2rem;
            margin-bottom: 15px;
        }
        .newsletter p {
            margin-bottom: 25px;
            font-size: 1.1rem;
        }
        .newsletter-form {
            display: flex;
            gap: 10px;
            max-width: 500px;
            margin: 0 auto;
        }
        .newsletter-input {
            flex: 1;
            padding: 12px 15px;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
        }
        .newsletter-button {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .newsletter-button:hover {
            background-color: #e69008;
        }
        /* Main Content Styles */
        main {
            padding: 40px 0;
        }
        .section-title {
            font-size: 1.8rem;
            margin-bottom: 30px;
            position: relative;
            padding-bottom: 10px;
        }
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background-color: var(--primary-color);
        }
        .posts-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 32px;
        }
        @media (min-width: 768px) {
            .posts-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        @media (min-width: 1024px) {
            .posts-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        .post-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        .post-card:hover {
            box-shadow: var(--hover-shadow);
            transform: translateY(-5px);
        }
        .post-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            display: block;
        }
        .post-content {
            padding: 24px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        .post-meta {
            display: flex;
            align-items: center;
            font-size: 0.85rem;
            color: var(--light-text);
            margin-bottom: 12px;
            flex-wrap: wrap;
            gap: 8px;
        }
        .post-meta span:not(:last-child) {
            margin-right: 8px;
        }
        .post-meta .separator {
            color: var(--light-text);
        }
        .post-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 16px;
            line-height: 1.4;
            color: var(--text-color);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            flex-grow: 1;
        }
        .post-title:hover {
            color: var(--primary-color);
        }
        .post-excerpt {
            color: var(--light-text);
            margin-bottom: 20px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            font-size: 0.95rem;
        }
        .post-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: auto;
        }
        .tag {
            background-color: #f3f4f6;
            color: #4b5563;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 40px;
        }
        .pagination-btn {
            padding: 8px 16px;
            border: 1px solid var(--border-color);
            background-color: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }
        .pagination-btn:hover:not(:disabled) {
            background-color: #f3f4f6;
        }
        .pagination-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            grid-column: 1 / -1;
        }
        .empty-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto 24px;
            color: #9ca3af;
        }
        .empty-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-color);
        }
        .empty-message {
            color: var(--light-text);
            margin-bottom: 24px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }
        .clear-btn {
            padding: 10px 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s ease;
        }
        .clear-btn:hover {
            background-color: #16a34a;
        }
        /* Post Detail View */
        .post-detail {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        .back-btn {
            display: inline-flex;
            align-items: center;
            color: var(--primary-color);
            font-weight: 500;
            margin-bottom: 24px;
            cursor: pointer;
            transition: color 0.2s ease;
            background: none;
            border: none;
            font-size: 1rem;
        }
        .back-btn:hover {
            color: #16a34a;
        }
        .post-detail-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 16px;
            line-height: 1.3;
        }
        .post-detail-meta {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            font-size: 0.9rem;
            color: var(--light-text);
            margin-bottom: 16px;
            gap: 16px;
        }
        .author-profile {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .author-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            object-fit: cover;
        }
        .post-detail-image {
            width: 100%;
            height: 400px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 32px;
        }
        .post-detail-content {
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 40px;
            color: var(--text-color);
        }
        .post-detail-tags {
            border-top: 1px solid var(--border-color);
            padding-top: 24px;
            margin-bottom: 40px;
        }
        .post-detail-tags h3 {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 16px;
        }
        .share-section {
            border-top: 1px solid var(--border-color);
            padding-top: 32px;
            margin-top: 24px;
        }
        .share-section h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 20px;
        }
        .share-buttons {
            display: flex;
            gap: 12px;
        }
        .share-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            cursor: pointer;
            transition: opacity 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .share-btn:hover {
            opacity: 0.9;
        }
        .facebook-btn {
            background-color: #1877f2;
        }
        .whatsapp-btn {
            background-color: #25D366;
        }
        /* Page View (for About, Contact, etc.) */
        .page-view {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        .page-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 24px;
            color: var(--primary-color);
            text-align: center;
        }
        .page-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            line-height: 1.8;
            font-size: 1.1rem;
        }
        .page-section {
            margin-bottom: 30px;
        }
        .page-section h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: var(--secondary-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 8px;
        }
        .contact-info {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .contact-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px;
            background: #f9fafb;
            border-radius: 8px;
            transition: background-color 0.2s;
        }
        .contact-item:hover {
            background: #f3f4f6;
        }
        .contact-icon {
            width: 40px;
            height: 40px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        /* Contact Form */
        .contact-form {
            margin-top: 30px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-color);
        }
        .form-input, .form-textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
        }
        .form-textarea {
            min-height: 150px;
            resize: vertical;
        }
        .submit-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .submit-btn:hover {
            background-color: var(--secondary-color);
        }
        /* Footer */
        footer {
            background-color: white;
            border-top: 1px solid var(--border-color);
            padding: 60px 0 30px;
            margin-top: 80px;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 40px;
        }
        .footer-column {
            flex: 1;
            min-width: 200px;
            text-align: center;
        }
        @media (max-width: 768px) {
            .footer-content {
                flex-direction: column;
                align-items: center;
            }
        }
        .footer-logo {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--primary-color);
        }
        .footer-description {
            color: var(--light-text);
            margin-bottom: 24px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        .footer-links {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin: 0 auto;
        }
        .footer-link {
            color: #9ca3af;
            font-size: 1rem;
            transition: color 0.2s ease;
            text-decoration: none;
            padding: 8px;
            border-radius: 4px;
            text-align: center;
        }
        .footer-link:hover {
            color: var(--text-color);
            background-color: #f3f4f6;
        }
        .social-links {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin: 0 auto;
        }
        .social-link {
            color: #9ca3af;
            font-size: 1rem;
            transition: color 0.2s ease;
            text-decoration: none;
            padding: 8px;
            border-radius: 4px;
            text-align: center;
        }
        .social-link:hover {
            color: var(--text-color);
            background-color: #f3f4f6;
        }
        .copyright {
            text-align: center;
            color: var(--light-text);
            font-size: 0.9rem;
            padding-top: 24px;
            border-top: 1px solid var(--border-color);
            width: 100%;
        }
        /* Loading Spinner */
        .loading-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 300px;
            grid-column: 1 / -1;
        }
        .spinner {
            width: 48px;
            height: 48px;
            border: 4px solid rgba(34, 197, 94, 0.1);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 16px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .loading-text {
            color: var(--light-text);
        }
        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #16a34a;
            color: white;
            padding: 12px 24px;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .toast.show {
            opacity: 1;
        }
        /* Error State */
        .error-state {
            text-align: center;
            padding: 60px 20px;
            color: #ef4444;
            grid-column: 1 / -1;
            display: none;
        }
        .error-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto 24px;
            color: #ef4444;
        }
        .error-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 8px;
        }
        .error-message {
            color: #ef4444;
            margin-bottom: 24px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }
        .retry-btn {
            padding: 10px 20px;
            background-color: #ef4444;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s ease;
        }
        .retry-btn:hover {
            background-color: #dc2626;
        }
        /* Overlay */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }
        .overlay.active {
            display: block;
        }
        /* Responsive Design */
        @media (max-width: 768px) {
            :root {
                --header-height: 70px;
            }
            .header-container {
                padding: 0 15px;
            }
            .desktop-nav {
                display: none;
            }
            .menu-toggle {
                display: block;
            }
            .search-container {
                width: 180px;
            }
            .hero {
                padding: 60px 0;
            }
            .hero h2 {
                font-size: 2rem;
            }
            .hero p {
                font-size: 1rem;
            }
            .newsletter-form {
                flex-direction: column;
            }
            .post-detail-image {
                height: 300px;
            }
            .post-detail-title {
                font-size: 1.5rem;
            }
            .share-buttons {
                flex-direction: column;
            }
        }
        /* Utility Classes */
        .hidden {
            display: none !important;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        /* Related Posts Section */
        .related-posts-section {
            margin-top: 40px;
            padding-top: 32px;
            border-top: 1px solid var(--border-color);
        }
        .related-posts-section h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--secondary-color);
        }
        .related-posts-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 24px;
        }
        .related-post-card {
            display: flex;
            gap: 16px;
            background: white;
            padding: 16px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        .related-post-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--hover-shadow);
        }
        .related-post-card img {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 8px;
        }
        .related-post-card-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .related-post-card h4 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 8px;
            line-height: 1.3;
            color: var(--text-color);
        }
        .related-post-card h4:hover {
            color: var(--primary-color);
        }
        .related-post-card p {
            font-size: 0.85rem;
            color: var(--light-text);
            margin: 0;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-container">
            <div class="logo">
                <a href="/" id="homeLink" class="logo-link">
                    <h1>Bandar Urban Farm</h1>
                </a>
                <p>Transformasi lahan sempit perkotaan untuk beternak dan berkebun</p>
            </div>
            <!-- Desktop Navigation (will be populated dynamically) -->
            <nav class="desktop-nav">
                <ul id="desktopNavMenu">
                    <!-- Menu items will be inserted here by JavaScript -->
                </ul>
            </nav>
            <div class="header-actions">
                <div class="search-container">
                    <span class="search-icon">üîç</span>
                    <input type="text" class="search-input" id="searchInput" placeholder="Cari artikel...">
                </div>
                <button class="menu-toggle" id="menuToggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </header>
    <!-- Mobile Navigation Menu -->
    <div class="nav-menu" id="navMenu">
        <span class="close-menu" id="closeMenu">&times;</span>
        <h3>Menu</h3>
        <ul id="mobileNavMenu">
            <!-- Menu items will be inserted here by JavaScript -->
        </ul>
    </div>
    <!-- Overlay -->
    <div class="overlay" id="overlay"></div>
    <!-- Hero Section -->
    <section class="hero">
        <div class="container hero-content">
            <h2>Tumbuhkan Hijauan Di Sekitar Kita</h2>
            <p>Petunjuk dan tips beternak dan berkebun di lahan sempit untuk kebutuhan harian dan peluang bisnis. Dapatkan Ebook Gratis Untuk 10 Orang Pertama!</p>
            <a href="https://wa.me/6285773009666" target="_blank" class="cta-button">Saya Mau</a>
        </div>
    </section>
    <!-- Main Content -->
    <main class="container">
        <!-- Home Page (Blog) -->
        <div class="page active" id="homePage">
            <h2 class="section-title">Artikel Terkini</h2>
            <!-- Loading State -->
            <div id="loading" class="loading-container">
                <div class="spinner"></div>
                <p class="loading-text">Memuat artikel...</p>
            </div>
            <!-- Error State -->
            <div id="errorState" class="error-state">
                <svg class="error-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <h3 class="error-title">Gagal Memuat Artikel</h3>
                <p class="error-message">Kami tidak dapat memuat artikel. Silakan coba lagi nanti.</p>
                <button id="retryBtn" class="retry-btn">Coba Lagi</button>
            </div>
            <!-- Blog Posts Grid -->
            <div id="postsGrid" class="posts-grid hidden"></div>
            <!-- Empty State -->
            <div id="emptyState" class="empty-state hidden">
                <svg class="empty-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 12h6m-6-4h6m2 5.291A7.962 7.962 0 0112 15c-2.34 0-4.467-.827-6.08-2.147M12 15v2m-6-2v2m12-2v2"></path>
                </svg>
                <h3 class="empty-title">Tidak ada artikel ditemukan</h3>
                <p class="empty-message">Coba sesuaikan pencarian atau filter untuk menemukan apa yang Anda cari.</p>
                <button id="clearSearch" class="clear-btn">Hapus pencarian</button>
            </div>
            <!-- Pagination -->
            <div id="pagination" class="pagination hidden"></div>
        </div>

        <!-- Dynamic Page View (for About, Contact, Author, etc.) -->
        <div class="page" id="pageView" style="display: none;">
            <div class="page-view">
                <button id="backToHomeBtn" class="back-btn">‚Üê Ke Beranda</button>
                <h1 class="page-title" id="pageTitle">Judul Halaman</h1>
                <div class="page-content" id="pageContent">
                    <!-- Content will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Post Detail View -->
        <div class="page" id="postDetailView" style="display: none;">
            <!-- Content will be generated dynamically -->
        </div>
    </main>
    <!-- Toast Notification -->
    <div id="toast" class="toast">Tautan disalin ke clipboard!</div>
    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3 class="footer-logo">Bandar Urban Farm</h3>
                    <p class="footer-description">Membangun komunitas, satu kebun perkotaan pada satu waktu</p>
                </div>
                <div class="footer-column">
                    <h4 style="margin: 20px 0 10px; color: var(--text-color);">Tautan</h4>
                    <div class="footer-links">
                        <a href="/tool/linebreak.html" class="footer-link">Blog Tool</a>
                        <a href="#" class="footer-link" data-page="about">Tentang</a>
                        <a href="#" class="footer-link" data-page="contact">Kontak</a>
                        <a href="#" class="footer-link" data-page="author">Penulis</a>
                    </div>
                </div>
                <div class="footer-column">
                    <h4 style="margin: 20px 0 10px; color: var(--text-color);">Media Sosial</h4>
                    <div class="social-links">
                        <a href="https://facebook.com/bandarurbanfarm" target="_blank" class="social-link">Facebook</a>
                        <a href="https://instagram.com/bandarurbanfarm" target="_blank" class="social-link">Instagram</a>
                        <a href="https://tiktok.com/@bandarurbanfarm" target="_blank" class="social-link">TikTok</a>
                        <a href="https://youtube.com/@bandarurbanfarm" target="_blank" class="social-link">YouTube</a>
                    </div>
                </div>
            </div>
            <div class="copyright">
                &copy; <span id="year">2024</span> Bandar Urban Farm. All rights reserved.
            </div>
        </div>
    </footer>
    <script>
        // DOM Elements
        const loadingElement = document.getElementById('loading');
        const postsGridElement = document.getElementById('postsGrid');
        const emptyStateElement = document.getElementById('emptyState');
        const paginationElement = document.getElementById('pagination');
        const searchInput = document.getElementById('searchInput');
        const clearSearchBtn = document.getElementById('clearSearch');
        const errorStateElement = document.getElementById('errorState');
        const retryBtn = document.getElementById('retryBtn');
        const menuToggle = document.getElementById('menuToggle');
        const navMenu = document.getElementById('navMenu');
        const closeMenu = document.getElementById('closeMenu');
        const overlay = document.getElementById('overlay');
        const yearElement = document.getElementById('year');
        const homeLink = document.getElementById('homeLink');
        const desktopNavMenu = document.getElementById('desktopNavMenu');
        const mobileNavMenu = document.getElementById('mobileNavMenu');
        const homePage = document.getElementById('homePage');
        const pageView = document.getElementById('pageView');
        const postDetailView = document.getElementById('postDetailView');
        const pageTitle = document.getElementById('pageTitle');
        const pageContent = document.getElementById('pageContent');
        const backToHomeBtn = document.getElementById('backToHomeBtn');

        // Set current year
        yearElement.textContent = new Date().getFullYear();

        // State
        let blogPosts = [];
        let pagesData = []; // New: Store pages data from CSV
        let currentPage = 1;
        const postsPerPage = 6;
        let searchTerm = '';
        let filteredPosts = [];
        let currentPost = null;
        let isLoading = true;

        // Format date
        function formatDate(dateString) {
            if (!dateString) return 'Tanggal tidak diketahui';
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return new Date(dateString).toLocaleDateString('id-ID', options);
        }

        // Generate SEO-friendly URL with post title
        function generatePermalink(post) {
            const baseUrl = window.location.origin + window.location.pathname;
            // Create a URL-friendly slug from the title
            const titleSlug = post.title
                .toLowerCase()
                .replace(/[^a-z0-9]+/g, '-')
                .replace(/(^-|-$)/g, '');
            return `${baseUrl}post-${titleSlug}`;
        }

        // Update document title for SEO
        function updateDocumentTitle(title) {
            if (title) {
                document.title = `${title} - Bandar Urban Farm`;
            } else {
                document.title = "Bandar Urban Farm - Transformasi lahan sempit perkotaan untuk beternak dan berkebun";
            }
        }

        // Parse CSV to array of objects
        function parseCSV(csv) {
            // Split by either \r\n or \n to handle different line endings
            const lines = csv.split(/\r?\n/).filter(line => line.trim() !== '');
            if (lines.length === 0) return [];
            
            const headers = lines[0].split(',').map(h => h.trim());
            return lines.slice(1).map(line => {
                const values = line.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                return headers.reduce((obj, header, i) => {
                    let value = values[i] ? values[i].trim() : '';
                    // Handle quoted values
                    if (value.startsWith('"') && value.endsWith('"')) {
                        value = value.slice(1, -1).replace(/""/g, '"'); // Handle escaped quotes
                    }
                    obj[header] = value;
                    return obj;
                }, {});
            }).filter(item => item.id || item.title); // Filter out empty rows
        }

        // Load blog posts from external CSV
        function loadBlogPosts() {
            const csvUrl = "https://bandarurbanfarm.github.io/blogposts.csv";
            return fetch(csvUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.text();
                })
                .then(csvText => {
                    try {
                        blogPosts = parseCSV(csvText);
                        // Process tags if they exist
                        blogPosts.forEach(post => {
                            if (post.tags && typeof post.tags === 'string') {
                                post.tags = post.tags.split('|').map(tag => tag.trim()).filter(tag => tag);
                            } else {
                                post.tags = [];
                            }
                        });
                        console.log('Loaded blog posts:', blogPosts);
                        if (blogPosts.length === 0) {
                            throw new Error('No valid posts found in CSV data');
                        }
                        filteredPosts = [...blogPosts];
                        return true;
                    } catch (error) {
                        console.error('Error processing CSV data:', error);
                        throw error;
                    }
                })
                .catch(error => {
                    console.error('Error loading external CSV:', error);
                    throw error;
                });
        }

        // Load pages from external CSV (for About, Contact, Author, etc.)
        function loadPagesData() {
            const pagesCsvUrl = "https://bandarurbanfarm.github.io/pages.csv";
            return fetch(pagesCsvUrl)
                .then(response => {
                    if (!response.ok) {
                        console.warn('Pages CSV not found, using default menu');
                        // Return default pages if CSV doesn't exist
                        return [
                            { id: 'about', title: 'Tentang', slug: 'about', menu_title: 'Tentang', content: '<h3>Tentang Bandar Urban Farm</h3><p>Bandar Urban Farm adalah platform yang didedikasikan untuk membantu masyarakat perkotaan dalam memanfaatkan lahan sempit untuk kegiatan berkebun dan beternak. Kami percaya bahwa setiap jengkal tanah dapat menjadi sumber kehidupan.</p><p>Didirikan oleh Wahyudi, seorang praktisi urban farming yang telah mengembangkan berbagai teknik inovatif untuk memaksimalkan potensi lahan terbatas di lingkungan perkotaan.</p>' },
                            { id: 'contact', title: 'Kontak', slug: 'contact', menu_title: 'Kontak', content: '<h3>Hubungi Kami</h3><div class="contact-info"><div class="contact-item"><div class="contact-icon"><i class="fas fa-phone"></i></div><div><strong>Telepon:</strong> <a href="tel:+6285773009666">+62 857-7300-9666</a></div></div><div class="contact-item"><div class="contact-icon"><i class="fab fa-whatsapp"></i></div><div><strong>WhatsApp:</strong> <a href="https://wa.me/6285773009666" target="_blank">+62 857-7300-9666</a></div></div><div class="contact-item"><div class="contact-icon"><i class="fas fa-envelope"></i></div><div><strong>Email:</strong> <a href="mailto:info@bandarurbanfarm.com">info@bandarurbanfarm.com</a></div></div></div><h3>Kirim Pesan</h3><form class="contact-form"><div class="form-group"><label class="form-label" for="name">Nama</label><input type="text" id="name" class="form-input" required></div><div class="form-group"><label class="form-label" for="email">Email</label><input type="email" id="email" class="form-input" required></div><div class="form-group"><label class="form-label" for="message">Pesan</label><textarea id="message" class="form-textarea" required></textarea></div><button type="submit" class="submit-btn">Kirim Pesan</button></form>' },
                            { id: 'author', title: 'Penulis', slug: 'author', menu_title: 'Penulis', content: '<h3>Wahyudi - Pendiri Bandar Urban Farm</h3><p>Wahyudi adalah seorang praktisi urban farming dengan pengalaman lebih dari 5 tahun dalam mengembangkan teknik berkebun dan beternak di lahan terbatas. Beliau memulai perjalanan ini dari halaman belakang rumahnya yang sempit, dan kini telah membantu ratusan orang untuk melakukan hal yang sama.</p><p>Melalui Bandar Urban Farm, Wahyudi berbagi pengetahuan, tips, dan pengalaman praktis untuk membantu masyarakat perkotaan menciptakan sumber pangan mandiri di rumah mereka masing-masing.</p><p>"Setiap jengkal tanah adalah kesempatan untuk menumbuhkan kehidupan" - Wahyudi</p>' }
                        ];
                    }
                    return response.text();
                })
                .then(csvText => {
                    if (typeof csvText === 'string') {
                        pagesData = parseCSV(csvText);
                        console.log('Loaded pages data:', pagesData);
                        return pagesData;
                    } else {
                        // Already returned default data
                        return csvText;
                    }
                })
                .catch(error => {
                    console.warn('Error loading pages CSV, using default menu:', error);
                    // Return default pages if there's an error
                    return [
                        { id: 'about', title: 'Tentang', slug: 'about', menu_title: 'Tentang', content: '<h3>Tentang Bandar Urban Farm</h3><p>Bandar Urban Farm adalah platform yang didedikasikan untuk membantu masyarakat perkotaan dalam memanfaatkan lahan sempit untuk kegiatan berkebun dan beternak. Kami percaya bahwa setiap jengkal tanah dapat menjadi sumber kehidupan.</p><p>Didirikan oleh Wahyudi, seorang praktisi urban farming yang telah mengembangkan berbagai teknik inovatif untuk memaksimalkan potensi lahan terbatas di lingkungan perkotaan.</p>' },
                        { id: 'contact', title: 'Kontak', slug: 'contact', menu_title: 'Kontak', content: '<h3>Hubungi Kami</h3><div class="contact-info"><div class="contact-item"><div class="contact-icon"><i class="fas fa-phone"></i></div><div><strong>Telepon:</strong> <a href="tel:+6285773009666">+62 857-7300-9666</a></div></div><div class="contact-item"><div class="contact-icon"><i class="fab fa-whatsapp"></i></div><div><strong>WhatsApp:</strong> <a href="https://wa.me/6285773009666" target="_blank">+62 857-7300-9666</a></div></div><div class="contact-item"><div class="contact-icon"><i class="fas fa-envelope"></i></div><div><strong>Email:</strong> <a href="mailto:info@bandarurbanfarm.com">info@bandarurbanfarm.com</a></div></div></div><h3>Kirim Pesan</h3><form class="contact-form"><div class="form-group"><label class="form-label" for="name">Nama</label><input type="text" id="name" class="form-input" required></div><div class="form-group"><label class="form-label" for="email">Email</label><input type="email" id="email" class="form-input" required></div><div class="form-group"><label class="form-label" for="message">Pesan</label><textarea id="message" class="form-textarea" required></textarea></div><button type="submit" class="submit-btn">Kirim Pesan</button></form>' },
                        { id: 'author', title: 'Penulis', slug: 'author', menu_title: 'Penulis', content: '<h3>Wahyudi - Pendiri Bandar Urban Farm</h3><p>Wahyudi adalah seorang praktisi urban farming dengan pengalaman lebih dari 5 tahun dalam mengembangkan teknik berkebun dan beternak di lahan terbatas. Beliau memulai perjalanan ini dari halaman belakang rumahnya yang sempit, dan kini telah membantu ratusan orang untuk melakukan hal yang sama.</p><p>Melalui Bandar Urban Farm, Wahyudi berbagi pengetahuan, tips, dan pengalaman praktis untuk membantu masyarakat perkotaan menciptakan sumber pangan mandiri di rumah mereka masing-masing.</p><p>"Setiap jengkal tanah adalah kesempatan untuk menumbuhkan kehidupan" - Wahyudi</p>' }
                    ];
                });
        }

        // Generate navigation menus from pages data
        function generateNavigationMenus() {
            // Clear existing menu items
            desktopNavMenu.innerHTML = '';
            mobileNavMenu.innerHTML = '';
            
            // Add Home to both menus
            const homeDesktopItem = document.createElement('li');
            homeDesktopItem.innerHTML = '<a href="/" class="nav-link active" data-page="home">Beranda</a>';
            desktopNavMenu.appendChild(homeDesktopItem);
            
            const homeMobileItem = document.createElement('li');
            homeMobileItem.innerHTML = '<a href="/" class="nav-link active" data-page="home"><i class="fas fa-home"></i> Beranda</a>';
            mobileNavMenu.appendChild(homeMobileItem);
            
            // Add pages from CSV to menus
            pagesData.forEach(page => {
                // Desktop menu
                const desktopItem = document.createElement('li');
                desktopItem.innerHTML = `<a href="#" class="nav-link" data-page="${page.slug}">${page.menu_title || page.title}</a>`;
                desktopNavMenu.appendChild(desktopItem);
                
                // Mobile menu
                const mobileItem = document.createElement('li');
                // Add appropriate icons based on page type
                let icon = 'fas fa-info-circle';
                if (page.slug === 'contact') icon = 'fas fa-envelope';
                if (page.slug === 'author') icon = 'fas fa-user';
                
                mobileItem.innerHTML = `<a href="#" class="nav-link" data-page="${page.slug}"><i class="${icon}"></i> ${page.menu_title || page.title}</a>`;
                mobileNavMenu.appendChild(mobileItem);
            });
            
            // Add event listeners to menu items
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const pageSlug = this.getAttribute('data-page');
                    
                    if (pageSlug === 'home') {
                        showHomePage();
                    } else {
                        const pageData = pagesData.find(p => p.slug === pageSlug);
                        if (pageData) {
                            showPage(pageData);
                        }
                    }
                    
                    // Update active state
                    document.querySelectorAll('.nav-link').forEach(navLink => {
                        navLink.classList.remove('active');
                    });
                    this.classList.add('active');
                });
            });
        }

        // Show home page
        function showHomePage() {
            // Hide other views
            pageView.style.display = 'none';
            postDetailView.style.display = 'none';
            
            // Show home page
            homePage.classList.remove('hidden');
            homePage.classList.add('active');
            
            // Update URL
            window.history.pushState({ page: 'home' }, 'Bandar Urban Farm', window.location.pathname);
            
            // Update document title
            updateDocumentTitle();
        }

        // Show page (About, Contact, Author, etc.)
        function showPage(pageData) {
            // Hide other views
            homePage.classList.remove('active');
            homePage.classList.add('hidden');
            postDetailView.style.display = 'none';
            
            // Show page view
            pageView.style.display = 'block';
            
            // Set page title and content
            pageTitle.textContent = pageData.title;
            pageContent.innerHTML = pageData.content || 'Konten tidak tersedia.';
            
            // Update URL
            window.history.pushState({ page: pageData.slug }, pageData.title, `/${pageData.slug}`);
            
            // Update document title
            updateDocumentTitle(pageData.title);
            
            // Handle form submission if it's a contact form
            if (pageData.slug === 'contact') {
                const contactForm = pageContent.querySelector('.contact-form');
                if (contactForm) {
                    contactForm.addEventListener('submit', function(e) {
                        e.preventDefault();
                        // Here you would typically send the form data to a server
                        // For now, we'll just show an alert
                        alert('Terima kasih atas pesan Anda! Kami akan segera menghubungi Anda.');
                        contactForm.reset();
                    });
                }
            }
        }

        // Show error state
        function showErrorState() {
            loadingElement.classList.add('hidden');
            errorStateElement.classList.remove('hidden');
        }

        // Retry fetching data
        function retryFetch() {
            errorStateElement.classList.add('hidden');
            loadingElement.classList.remove('hidden');
            init();
        }

        // Create post card
        function createPostCard(post) {
            const card = document.createElement('article');
            card.className = 'post-card fade-in';
            // Ensure we have fallback values for all fields
            const title = post.title || 'Postingan Tanpa Judul';
            const author = "Wahyudi";
            const date = post.date ? formatDate(post.date) : 'Tanggal tidak diketahui';
            const image = post.image || 'https://placehold.co/800x400/22c55e/ffffff?text=Bandar+Urban+Farm';
            const excerpt = post.excerpt || (post.content ? post.content.substring(0, 150) + '...' : 'Tidak ada ringkasan tersedia.');
            const tags = post.tags && post.tags.length ? post.tags : ['Tidak ada tag'];
            card.innerHTML = `
                <img src="${image}" alt="${title}" class="post-image">
                <div class="post-content">
                    <div class="post-meta">
                        <div class="author-profile">
                            <img src="https://placehold.co/50x50/22c55e/ffffff?text=W" alt="Wahyudi" class="author-avatar">
                            <span>Oleh <a href="https://wa.me/6285773009666" target="_blank" style="color: var(--primary-color); text-decoration: underline;">${author}</a></span>
                        </div>
                        <span class="separator">‚Ä¢</span>
                        <span>${date}</span>
                    </div>
                    <h2 class="post-title">${title}</h2>
                    <p class="post-excerpt">${excerpt}</p>
                    <div class="post-tags">
                        ${tags.slice(0, 3).map(tag => `<span class="tag">${tag}</span>`).join('')}
                        ${tags.length > 3 ? `<span class="tag">+${tags.length - 3}</span>` : ''}
                    </div>
                </div>
            `;
            card.addEventListener('click', () => {
                // Create a URL with the post slug
                const titleSlug = post.title
                    .toLowerCase()
                    .replace(/[^a-z0-9]+/g, '-')
                    .replace(/(^-|-$)/g, '');
                const postUrl = `post-${titleSlug}`;
                // Update the URL
                window.history.pushState({ post: titleSlug }, post.title, postUrl);
                // Show the post detail
                showPostDetail(post);
            });
            return card;
        }

        // Show post detail
        function showPostDetail(post) {
            // Hide other views
            homePage.classList.remove('active');
            homePage.classList.add('hidden');
            pageView.style.display = 'none';
            
            // Show post detail view
            postDetailView.style.display = 'block';
            
            // Create a new div for the post detail
            const postDetailHTML = `
                <div class="post-detail" id="dynamicPostDetail">
                    <button id="backBtn" class="back-btn">‚Üê Ke Beranda</button>
                    <h1 class="post-detail-title">${post.title || 'Postingan Tanpa Judul'}</h1>
                    <div class="post-detail-meta">
                        <div class="author-profile">
                            <img src="https://placehold.co/50x50/22c55e/ffffff?text=W" alt="Wahyudi" class="author-avatar">
                            <span>Oleh <a href="https://wa.me/6285773009666" target="_blank" style="color: var(--primary-color); text-decoration: underline;">Wahyudi</a></span>
                        </div>
                        <span class="separator">‚Ä¢</span>
                        <span>${post.date ? formatDate(post.date) : 'Tanggal tidak diketahui'}</span>
                    </div>
                    <img src="${post.image || 'https://placehold.co/800x400/22c55e/ffffff?text=Bandar+Urban+Farm'}" alt="${post.title || 'Gambar postingan blog'}" class="post-detail-image">
                    <div class="post-detail-content">${post.content || 'Tidak ada konten tersedia.'}</div>
                    <div class="post-detail-tags">
                        <h3>Tags:</h3>
                        <div class="post-tags">
                            ${(post.tags && post.tags.length ? post.tags : ['Tidak ada tag']).map(tag => `<span class="tag">${tag}</span>`).join('')}
                        </div>
                    </div>
                    <div class="share-section">
                        <h3>Bagikan postingan ini</h3>
                        <div class="share-buttons">
                            <button class="share-btn facebook-btn" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}', '_blank')">
                                <i class="fab fa-facebook-f"></i> Facebook
                            </button>
                            <button class="share-btn whatsapp-btn" onclick="window.open('https://wa.me/?text=${encodeURIComponent(post.title)}%20${encodeURIComponent(window.location.href)}', '_blank')">
                                <i class="fab fa-whatsapp"></i> WhatsApp
                            </button>
                        </div>
                    </div>

                    <!-- RELATED POSTS SECTION -->
                    <div class="related-posts-section">
                        <h3>Baca Juga</h3>
                        <div class="related-posts-grid">
                            ${(() => {
                                // Find related posts (sharing at least one tag)
                                const relatedPosts = blogPosts.filter(p => {
                                    // Don't include the current post itself
                                    if (p.id === post.id) return false;
                                    // Check if there's any overlap in tags
                                    if (!p.tags || !post.tags) return false;
                                    return p.tags.some(tag => post.tags.includes(tag));
                                }).slice(0, 3); // Limit to 3 related posts

                                if (relatedPosts.length === 0) {
                                    return `<p style="text-align: center; color: var(--light-text); grid-column: 1 / -1;">Tidak ada artikel terkait yang ditemukan.</p>`;
                                }

                                return relatedPosts.map(relatedPost => `
                                    <div class="related-post-card" data-post-id="${relatedPost.id}">
                                        <img src="${relatedPost.image || 'https://placehold.co/150x150/22c55e/ffffff?text=BUF'}" alt="${relatedPost.title}">
                                        <div class="related-post-card-content">
                                            <h4>${relatedPost.title}</h4>
                                            <p>${relatedPost.excerpt ? relatedPost.excerpt.substring(0, 100) + '...' : ''}</p>
                                        </div>
                                    </div>
                                `).join('');
                            })()}
                        </div>
                    </div>
                    <!-- END OF RELATED POSTS SECTION -->
                </div>
            `;
            
            // Clear and set content
            postDetailView.innerHTML = postDetailHTML;
            
            // Add event listener for the back button
            document.getElementById('backBtn').addEventListener('click', () => {
                showHomePage();
            });

            // Add click event listeners to related post cards
            document.querySelectorAll('.related-post-card').forEach(card => {
                card.addEventListener('click', (e) => {
                    // Get the post ID from the data attribute
                    const postId = card.getAttribute('data-post-id');
                    const relatedPost = blogPosts.find(p => p.id === postId);
                    if (relatedPost) {
                        showPostDetail(relatedPost);
                        // Update URL
                        const titleSlug = relatedPost.title
                            .toLowerCase()
                            .replace(/[^a-z0-9]+/g, '-')
                            .replace(/(^-|-$)/g, '');
                        const postUrl = `post-${titleSlug}`;
                        window.history.pushState({ post: titleSlug }, relatedPost.title, postUrl);
                    }
                });
            });
            
            // Update document title
            updateDocumentTitle(post.title);
        }

        // Render posts
        function renderPosts() {
            console.log('Rendering posts, current page:', currentPage);
            // Clear grid
            postsGridElement.innerHTML = '';
            // Calculate pagination
            const indexOfLastPost = currentPage * postsPerPage;
            const indexOfFirstPost = indexOfLastPost - postsPerPage;
            const currentPosts = filteredPosts.slice(indexOfFirstPost, indexOfLastPost);
            console.log('Current posts to display:', currentPosts.length);
            // Render posts
            if (currentPosts.length === 0) {
                emptyStateElement.classList.remove('hidden');
                postsGridElement.classList.add('hidden');
                paginationElement.classList.add('hidden');
            } else {
                emptyStateElement.classList.add('hidden');
                postsGridElement.classList.remove('hidden');
                currentPosts.forEach(post => {
                    const postCard = createPostCard(post);
                    postsGridElement.appendChild(postCard);
                });
                // Show pagination if needed
                if (filteredPosts.length > postsPerPage) {
                    paginationElement.classList.remove('hidden');
                } else {
                    paginationElement.classList.add('hidden');
                }
            }
            // Render pagination
            renderPagination();
        }

        // Render pagination
        function renderPagination() {
            paginationElement.innerHTML = '';
            const totalPages = Math.ceil(filteredPosts.length / postsPerPage);
            if (totalPages <= 1) {
                paginationElement.classList.add('hidden');
                return;
            }
            paginationElement.classList.remove('hidden');
            // Previous button
            const prevBtn = document.createElement('button');
            prevBtn.className = 'pagination-btn';
            prevBtn.innerHTML = 'Sebelumnya';
            prevBtn.disabled = currentPage === 1;
            prevBtn.addEventListener('click', () => {
                if (currentPage > 1) {
                    currentPage--;
                    renderPosts();
                    window.scrollTo(0, 0);
                }
            });
            paginationElement.appendChild(prevBtn);
            // Page numbers
            for (let i = 1; i <= totalPages; i++) {
                const pageBtn = document.createElement('button');
                pageBtn.className = `pagination-btn ${i === currentPage ? 'active' : ''}`;
                pageBtn.textContent = i;
                pageBtn.addEventListener('click', () => {
                    currentPage = i;
                    renderPosts();
                    window.scrollTo(0, 0);
                });
                paginationElement.appendChild(pageBtn);
            }
            // Next button
            const nextBtn = document.createElement('button');
            nextBtn.className = 'pagination-btn';
            nextBtn.innerHTML = 'Selanjutnya';
            nextBtn.disabled = currentPage === totalPages;
            nextBtn.addEventListener('click', () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    renderPosts();
                    window.scrollTo(0, 0);
                }
            });
            paginationElement.appendChild(nextBtn);
        }

        // Filter posts
        function filterPosts() {
            searchTerm = searchInput.value.toLowerCase();
            filteredPosts = blogPosts.filter(post =>
                (post.title && post.title.toLowerCase().includes(searchTerm)) ||
                (post.content && post.content.toLowerCase().includes(searchTerm)) ||
                (post.tags && post.tags.some(tag => tag.toLowerCase().includes(searchTerm))) ||
                (post.author && post.author.toLowerCase().includes(searchTerm)) ||
                (post.excerpt && post.excerpt.toLowerCase().includes(searchTerm))
            );
            currentPage = 1;
            // Show appropriate view
            renderPosts();
        }

        // Check URL for post or page on load
        function checkUrlForPostOrPage() {
            const path = window.location.pathname;
            
            // Check for page (about, contact, author, etc.)
            if (path !== '/' && path !== window.location.origin + '/') {
                const pageSlug = path.substring(1); // Remove leading '/'
                const pageData = pagesData.find(p => p.slug === pageSlug);
                if (pageData) {
                    showPage(pageData);
                    return;
                }
            }
            
            // Check for post
            const hash = window.location.hash;
            if (hash.includes('post=')) {
                const postSlug = hash.split('=')[1];
                // Find post by converting title to slug format
                const post = blogPosts.find(p => {
                    const titleSlug = p.title
                        .toLowerCase()
                        .replace(/[^a-z0-9]+/g, '-')
                        .replace(/(^-|-$)/g, '');
                    return titleSlug === postSlug;
                });
                if (post) {
                    showPostDetail(post);
                    return;
                }
            }
            
            // If no post or page found, show home page
            showHomePage();
        }

        // Toggle navigation menu
        function toggleMenu() {
            navMenu.classList.toggle('active');
            overlay.classList.toggle('active');
            document.body.style.overflow = navMenu.classList.contains('active') ? 'hidden' : 'auto';
        }

        // Close menu
        function closeAll() {
            navMenu.classList.remove('active');
            overlay.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Initialize - Load both blog posts and pages
        async function init() {
            console.log('Initializing Bandar Urban Farm...');
            
            try {
                // Load blog posts
                await loadBlogPosts();
                
                // Load pages data
                await loadPagesData();
                
                // Generate navigation menus
                generateNavigationMenus();
                
                // Hide loading state
                loadingElement.classList.add('hidden');
                errorStateElement.classList.add('hidden');
                
                // Render blog posts
                renderPosts();
                
                // Check URL for post or page
                setTimeout(() => {
                    checkUrlForPostOrPage();
                }, 100);
                
                // Set up event listeners
                setupEventListeners();
                
            } catch (error) {
                console.error('Initialization failed:', error);
                showErrorState();
            }
        }

        // Set up event listeners
        function setupEventListeners() {
            searchInput.addEventListener('input', filterPosts);
            clearSearchBtn.addEventListener('click', () => {
                searchInput.value = '';
                filterPosts();
            });
            retryBtn.addEventListener('click', retryFetch);
            menuToggle.addEventListener('click', toggleMenu);
            closeMenu.addEventListener('click', toggleMenu);
            overlay.addEventListener('click', closeAll);
            
            // Add click event for home link
            homeLink.addEventListener('click', (e) => {
                e.preventDefault();
                showHomePage();
            });
            
            // Add click event for back to home button in page view
            backToHomeBtn.addEventListener('click', () => {
                showHomePage();
            });
        }

        // Start the application when DOM is loaded
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }

        // Add mobile-specific styling for header
        const mobileStyle = document.createElement('style');
        mobileStyle.textContent = `
            @media (max-width: 768px) {
                .logo h1 {
                    font-size: 1.5rem;
                }
                .logo p {
                    display: none;
                }
            }
        `;
        document.head.appendChild(mobileStyle);

        // Update logo text for mobile devices
        function updateLogoForMobile() {
            const logoH1 = document.querySelector('.logo h1');
            if (window.innerWidth <= 768) {
                logoH1.textContent = "BUF";
            } else {
                logoH1.textContent = "Bandar Urban Farm";
            }
        }

        // Call on load and resize
        window.addEventListener('load', updateLogoForMobile);
        window.addEventListener('resize', updateLogoForMobile);

        // Handle browser back/forward buttons
        window.addEventListener('popstate', function(event) {
            if (event.state && event.state.page) {
                if (event.state.page === 'home') {
                    showHomePage();
                } else {
                    const pageData = pagesData.find(p => p.slug === event.state.page);
                    if (pageData) {
                        showPage(pageData);
                    }
                }
            } else if (event.state && event.state.post) {
                // Find post by slug
                const postSlug = event.state.post;
                const post = blogPosts.find(p => {
                    const titleSlug = p.title
                        .toLowerCase()
                        .replace(/[^a-z0-9]+/g, '-')
                        .replace(/(^-|-$)/g, '');
                    return titleSlug === postSlug;
                });
                if (post) {
                    showPostDetail(post);
                } else {
                    showHomePage();
                }
            } else {
                showHomePage();
            }
        });
    </script>
</body>
</html>
